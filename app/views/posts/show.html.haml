= provide :my_title, "檢視貼文"
.container
  .row
    .post-title.col-12
      %h1
        = @post.title
        %span#collect-block
          = render 'collect'
      - @categories.each do |ca|
        %ul.list-inline
          %li
            [
            = ca.category.name
            ]

  .post-main.row
    .post-author.col-md-3
      - if @post.user.avatar?
        = image_tag @post.user.avatar, class: "img-responsive"
      - else
        %img.img-responsive.img-rounded(src="http://via.placeholder.com/150x150")/  
      %p= link_to @post.user.name, user_path(@post.user)
      - if current_user.friend?(@post.user)
        %p Friend
      - elsif current_user.nobody?(@post.user)
        %p 已忽略
      - elsif current_user.target?(@post.user) || current_user.inverse_nobodys?(@post.user)
        %p 已提出申請
      - else
        = link_to 'Add Friend', applyings_path(target_id: @post.user), method: :post, class: "btn btn-primary"
    .post-content.col-md-9
      - if @post.image?
        = image_tag @post.image, width: "300px"
      - else
        %img.img-responsive.img-rounded(src="http://via.placeholder.com/200x200")/  
      %p= @post.content
    .post-button
      = link_to edit_post_path(@post) do
        %i.fas.fa-pencil-alt.fa-2x
      = link_to post_path(@post), method: :delete, data: { confirm: "Are you sure?"} do
        %i.fas.fa-trash-alt.fa-2x

.container
  .row
    %hr/
    .comment#comment
      - @comments.each do |comment|
        .comment-each
          .comment-author
            - if comment.user.avatar?
              = image_tag comment.user.avatar, class: "img-responsive"
            - else
              %img.img-responsive.img-rounded(src="https://cdn.filestackcontent.com/z2xAtAcQTF7KgoD67Fpf")/  
            %p= comment.user.name
            = link_to 'Add Friend', "#", class: "btn btn-primary btn-sm"
          .comment-content
            %p= simple_format comment.content
          - if current_user.admin? || current_user == comment.user
            .comment-button
              = link_to edit_post_comment_path(@post, comment) do
                %i.fas.fa-pencil-alt.fa-2x
              = link_to post_comment_path(@post, comment), method: :delete, data: { confirm: "Are you sure?"} do
                %i.fas.fa-trash-alt.fa-2x  
          %hr/
      .text-center
        = paginate @comments
    = simple_form_for [@post, @comment], html: {class: "comment-form" } do |f|
      = f.input :content, placeholder: "Try to give tis post a comment!", label: false

      = f.submit nil, class: "btn btn-primary"
      = f.button :button, 'Cancel', type: :reset, class: "btn btn-default"